<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Olympics by Culture and Spending - The Olympic Advantage – Will Peters STA9750-2024-FALL</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Will Peters STA9750-2024-FALL</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Olympics by Culture and Spending - The Olympic Advantage</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="why-do-we-care-about-the-olympics" class="level2">
<h2 class="anchored" data-anchor-id="why-do-we-care-about-the-olympics">Why do we care about the Olympics</h2>
<p>For the purposes of this document I am going to encourage you to read the overall report that the team and I created on why we cared about the Olympics and what we sought out to figure out about the influences over the Olympics.</p>
<p>The main four components of the research were focused around:</p>
<ol type="1">
<li>The country’s economy</li>
<li>Investment and culture of sportiness (the individual report provided below with the research).</li>
<li>Geographic characteristics</li>
<li>Impact of being the host country</li>
</ol>
</section>
<section id="countrys-investment-into-sports-culture" class="level2">
<h2 class="anchored" data-anchor-id="countrys-investment-into-sports-culture">Country’s investment into sports culture</h2>
<p>To provide the introduction to this, it’s important to know what I was most curious about when preparing and some of the topical questions that I sought to answer. So the areas I was focusing on:</p>
<ol type="1">
<li>Sportiness of the population/culture, measured through:
<ol type="1">
<li>Elite Sports ranking</li>
<li>Hobbies involving sports
<ol type="1">
<li>Watching Sport</li>
<li>Health &amp; Fitness</li>
<li>Playing sport</li>
</ol></li>
<li>Sports Participation rate</li>
</ol></li>
<li>Financial Metrics of sportiness
<ol type="1">
<li>Fitness Applications</li>
<li>Fitness Spend</li>
<li>Gym memberships (per 100K)</li>
<li>Overall country spending on sports related equipment</li>
</ol></li>
</ol>
<p>This prelude to the topic was what influences from culture and spending most impact the ability to win an Olympic medal for a country. Leading to what is the correlation and causation of the factors and number of Olympic medals won and what is the likeliness of it being chance.</p>
<p>To start the analysis, if you are curious to know what libraries were used in this investigation expand the code below to see the list, that were either utilized or tested whilst developing the code.</p>
<details>
<summary>
Relevant libraries
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting a CRAN mirror to avoid errors</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org/"</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Install the required packages</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># List of packages to check and install if missing</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"priceR"</span>, <span class="st">"rvest"</span>, <span class="st">"dplyr"</span>, <span class="st">"googlesheets4"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rnaturalearth"</span>, <span class="st">"rnaturalearthdata"</span>, <span class="st">"sf"</span>, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"xml2"</span>, <span class="st">"tidyverse"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each package</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pkg <span class="cf">in</span> packages) {</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(pkg)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>) <span class="co"># Load the package after installation</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(priceR)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xml2)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<section id="geospatial-analysis" class="level3">
<h3 class="anchored" data-anchor-id="geospatial-analysis">Geospatial Analysis</h3>
<p>So the first source I went to for my data source, was Myprotein, and I know what you are thinking an odd location for a research database, however the Research by Adele Halsall provided a fascinating insight into overall sportiness especially in trying to measure sports culture which is never easy. She was kind enough to store her data on a google sheet, and as such that company with the googlesheets4 library meant I could extract into my table.</p>
<details>
<summary>
Pulling in MyProtein Sporties Country data
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sheet_id <span class="ot">&lt;-</span> <span class="st">"1JMS4D9Nx-qxokAkStZ-hJ9vCobphCVqWjZHSGsodlbE"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#this is the sheet utilized in googlesheets after the /spreadsheets/d/sheetid</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gs4_deauth</span>()</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># As it is publically accessible do not need a google account </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data with read_sheet pertaining to the googlesheets4 library</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_sheet</span>(sheet_id)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="at">n =</span> <span class="dv">10</span>,data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 12
   Country         `Olympic Medals` Winter Olympic Medal…¹ `Elite Sport Ranking`
   &lt;chr&gt;                      &lt;dbl&gt;                  &lt;dbl&gt;                 &lt;dbl&gt;
 1 Germany                     1346                    408                     1
 2 United States …             2522                    305                     7
 3 Sweden                       494                    158                     4
 4 Norway                       152                    368                     3
 5 Finland                      303                    167                    27
 6 Canada                       302                    199                     2
 7 Switzerland                  192                    153                     5
 8 Austria                       87                    232                    10
 9 Netherlands                  285                    130                    25
10 Australia                    507                     15                    13
# ℹ abbreviated name: ¹​`Winter Olympic Medals`
# ℹ 8 more variables: `Sports Participation Rate` &lt;dbl&gt;,
#   `Gym Memberships per 100k` &lt;dbl&gt;, `Hobbies - Health &amp; Fitness` &lt;dbl&gt;,
#   `Hobbies - Playing Sport` &lt;dbl&gt;, `Hobbies - Watching Sport` &lt;dbl&gt;,
#   `Fitness Apps` &lt;dbl&gt;, `Fitness Spend` &lt;dbl&gt;,
#   `Total Score (out of 100)` &lt;dbl&gt;</code></pre>
</div>
</div>
</details>
<p>Now whilst the above was useful for getting the data for analysis we needed to also enhance the information with Geospatial information for the purposes of mapping the information.</p>
<details>
<summary>
Pulling in the world map
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">"medium"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#This ne_countries is from the rnaturalearth library in R and contains country based information</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"Czechia"</span> <span class="sc">~</span> <span class="st">"Czech Republic"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"U.S. Virgin Is."</span> <span class="sc">~</span> <span class="st">"Virgin Islands"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"Côte d'Ivoire"</span> <span class="sc">~</span> <span class="st">"Ivory Coast"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"Dominican Rep."</span> <span class="sc">~</span> <span class="st">"Dominican Republic"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> name <span class="co"># Keep other values unchanged</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Tidied up the naming conventions of countries to align with the information provided in the MyProtein Sports review</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(world) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">geometry =</span> geometry)) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Geometries Plot"</span>, <span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#this is the same visualization as below and uses a native R library</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p>I have provided a visualization of the bare bones map provided in this analysis, the logic is hidden above in the code but want to share the insights generated.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Olympic_Spend_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Then after tidying everything up we combine the two pieces of data to present the information in a plotted format, instead of as a table, as a visual learner and observer it will help to make points clearer.</p>
<details>
<summary>
Data integration and mapping
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>merged_World_data <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(world,data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"name"</span> <span class="ot">=</span> <span class="st">"Country"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Elite Sport Ranking</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">84</span><span class="sc">-</span><span class="st">`</span><span class="at">Elite Sport Ranking</span><span class="st">`</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the purpose of the mutate in this case is given that the lower the number the better the performance i.e. Country ranked 1st performs better we took the inverse of worst performing country for the Elite Sports ranking as this aligns with other metrics where higher is better.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> merged_World_data) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Olympic Medals</span><span class="st">`</span>)) <span class="sc">+</span> <span class="co"># Use the 'medals' column for fill color</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"darkblue"</span>, <span class="at">name =</span> <span class="st">"Medals"</span>) <span class="sc">+</span> <span class="co"># Color gradient for medals</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Olympic Medals by Country"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Visualizing the Number of Medals Won"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"MyProtein"</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This is a duplication of the visualization naturally occuring however wanted to keep both so the code could be seen all together.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Olympic_Spend_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Next Compare each of the factors to analyse culture by mapping to each other of the 9 factors being (Olympic Medals, Winter Olympic Medals, Elite Sport Ranking, Sports Participation Rate, Gym Memberships per 100k, Hobbies - Health &amp; Fitness, Hobbies - Watching Sport, Fitness Apps, Fitness Spend). The code below shows how it was cleaned and tidied to analyse a country comparison.</p>
<details>
<summary>
Tidying up Factors and presenting
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> merged_World_data <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Olympic Medals</span><span class="st">`</span>, <span class="st">`</span><span class="at">Winter Olympic Medals</span><span class="st">`</span>, <span class="st">`</span><span class="at">Elite Sport Ranking</span><span class="st">`</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Sports Participation Rate</span><span class="st">`</span>, <span class="st">`</span><span class="at">Gym Memberships per 100k</span><span class="st">`</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Hobbies - Health &amp; Fitness</span><span class="st">`</span>, <span class="st">`</span><span class="at">Hobbies - Watching Sport</span><span class="st">`</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Fitness Apps</span><span class="st">`</span>, <span class="st">`</span><span class="at">Fitness Spend</span><span class="st">`</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Metric"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Metric) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Normalized_Value =</span> (Value <span class="sc">-</span> <span class="fu">min</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>           (<span class="fu">max</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot using normalized values</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> long_data) <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Normalized_Value), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> <span class="co"># Fill with normalized value</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"darkblue"</span>, <span class="at">name =</span> <span class="st">"Relative Value"</span>) <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Metric, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># Use shared scales for geometry</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Comparison of Fitness and Sports Metrics by Country"</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Normalized Values by Metric"</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Olympic_Spend_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As you can see above the data shows a lot of correlations that can be visually observed before being analysed so some primary comments would be between the Gym Members per 100K and the Sports Participation rate.</p>
<p>As an aside and an Australian I will note that in all of these images we perform quite successfully except for the performance in Winter Olympic Medals, which is understandable especially living so close to the beach and water it is easier for summer sports.</p>
<p>Some notes for the top performer of the Number of Olympic medals of the U.S, it appears that the Elite Sports Ranking, Gym memberships per 100k and other factors quite evidently overlap, but I am interesting in hearing everyone thoughts on what other factors you would have included to account for the performance in the olympics.</p>
<p>The next section is more rigorous analytics around these factors and how they overlap by starting to quantify the regression with a causation and correlation focus of the supporting factors around the numbers of Olympic medals won. This is where the visualization of this data moves from graph to Table and the data enthusiasts start to really pay attention.</p>
</section>
<section id="regression" class="level3">
<h3 class="anchored" data-anchor-id="regression">Regression</h3>
<p>As mentioned below the first part is to ensure that the data quality is high and a successful regression analysis can be performed. This is largely analyzing the table above with some additional data cleansing and pivoting to allow it to flow into the data analytics format provided by the R libraries.</p>
<details>
<summary>
Regression code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Merged_unmapped_World_Data <span class="ot">&lt;-</span> merged_World_data</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a separate data table to remove the geometry or location for each country to reduce the data size</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>Merged_unmapped_World_Data<span class="sc">$</span>geometry <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting the geometry to 0</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Merged_unmapped_World_Data<span class="sc">$</span><span class="st">`</span><span class="at">Olympic Medals</span><span class="st">`</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Dependent variable</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Independent variables</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> Merged_unmapped_World_Data <span class="sc">|&gt;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Elite Sport Ranking</span><span class="st">`</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Sports Participation Rate</span><span class="st">`</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Gym Memberships per 100k</span><span class="st">`</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Hobbies - Health &amp; Fitness</span><span class="st">`</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Hobbies - Playing Sport</span><span class="st">`</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Hobbies - Watching Sport</span><span class="st">`</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Fitness Apps</span><span class="st">`</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Fitness Spend</span><span class="st">`</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># COmbining all the data</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p>For the statistical analysis the Principal Component Analysis (PCA) was utilized across the data.</p>
<details>
<summary>
PCA Analysis
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is possible because ot the stats library and so easily sharable</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(X, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the first few principal components for regression</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>pca_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]) <span class="co"># Use the first 8 components</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>merged_data_pca <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y, pca_data)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the regression model</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>model_pca <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> merged_data_pca)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model code is suppressed below but used in a hidden run to show the table </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ ., data = merged_data_pca)

Residuals:
    Min      1Q  Median      3Q     Max 
-579.26 -103.39   -0.92   46.84 1677.87 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   115.06      20.66   5.568 1.50e-07 ***
PC1            74.32      13.12   5.663 9.68e-08 ***
PC2           -78.80      15.16  -5.200 7.91e-07 ***
PC3           -12.33      20.94  -0.589 0.557082    
PC4           -79.48      24.12  -3.295 0.001281 ** 
PC5           -37.92      24.51  -1.547 0.124435    
PC6           102.52      29.28   3.501 0.000643 ***
PC7            85.95      33.60   2.558 0.011717 *  
PC8            57.80      37.26   1.552 0.123300    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 239.2 on 125 degrees of freedom
Multiple R-squared:  0.429, Adjusted R-squared:  0.3925 
F-statistic: 11.74 on 8 and 125 DF,  p-value: 2.319e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(pca<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">PC1</th>
<th style="text-align: right;">PC2</th>
<th style="text-align: right;">PC3</th>
<th style="text-align: right;">PC4</th>
<th style="text-align: right;">PC5</th>
<th style="text-align: right;">PC6</th>
<th style="text-align: right;">PC7</th>
<th style="text-align: right;">PC8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Elite Sport Ranking</td>
<td style="text-align: right;">0.2552993</td>
<td style="text-align: right;">-0.4660090</td>
<td style="text-align: right;">0.1369448</td>
<td style="text-align: right;">-0.0525239</td>
<td style="text-align: right;">-0.5938219</td>
<td style="text-align: right;">0.5032198</td>
<td style="text-align: right;">0.1898671</td>
<td style="text-align: right;">-0.2328972</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sports Participation Rate</td>
<td style="text-align: right;">0.4068975</td>
<td style="text-align: right;">-0.4114166</td>
<td style="text-align: right;">0.0458514</td>
<td style="text-align: right;">0.1075156</td>
<td style="text-align: right;">0.0144703</td>
<td style="text-align: right;">-0.2951564</td>
<td style="text-align: right;">-0.7509729</td>
<td style="text-align: right;">-0.0148991</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gym Memberships per 100k</td>
<td style="text-align: right;">0.2073760</td>
<td style="text-align: right;">-0.5255337</td>
<td style="text-align: right;">0.1684044</td>
<td style="text-align: right;">-0.3650119</td>
<td style="text-align: right;">0.3755100</td>
<td style="text-align: right;">-0.2805787</td>
<td style="text-align: right;">0.4702557</td>
<td style="text-align: right;">0.2798986</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hobbies - Health &amp; Fitness</td>
<td style="text-align: right;">-0.3451803</td>
<td style="text-align: right;">-0.2808000</td>
<td style="text-align: right;">0.4469759</td>
<td style="text-align: right;">0.4093140</td>
<td style="text-align: right;">0.4742064</td>
<td style="text-align: right;">0.2136865</td>
<td style="text-align: right;">-0.0141170</td>
<td style="text-align: right;">-0.4048995</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hobbies - Playing Sport</td>
<td style="text-align: right;">-0.3299214</td>
<td style="text-align: right;">0.0866252</td>
<td style="text-align: right;">0.6851963</td>
<td style="text-align: right;">-0.1185995</td>
<td style="text-align: right;">-0.4554738</td>
<td style="text-align: right;">-0.4245194</td>
<td style="text-align: right;">-0.0453082</td>
<td style="text-align: right;">0.1017949</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hobbies - Watching Sport</td>
<td style="text-align: right;">-0.4549719</td>
<td style="text-align: right;">-0.1670587</td>
<td style="text-align: right;">-0.0248454</td>
<td style="text-align: right;">-0.5726510</td>
<td style="text-align: right;">0.1090661</td>
<td style="text-align: right;">0.4300852</td>
<td style="text-align: right;">-0.4107180</td>
<td style="text-align: right;">0.2664349</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fitness Apps</td>
<td style="text-align: right;">-0.4034741</td>
<td style="text-align: right;">-0.2929198</td>
<td style="text-align: right;">-0.4573991</td>
<td style="text-align: right;">-0.2066119</td>
<td style="text-align: right;">-0.1442053</td>
<td style="text-align: right;">-0.4106815</td>
<td style="text-align: right;">0.0539816</td>
<td style="text-align: right;">-0.5541982</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fitness Spend</td>
<td style="text-align: right;">-0.3584182</td>
<td style="text-align: right;">-0.3705714</td>
<td style="text-align: right;">-0.2677146</td>
<td style="text-align: right;">0.5479293</td>
<td style="text-align: right;">-0.2028292</td>
<td style="text-align: right;">-0.0376422</td>
<td style="text-align: right;">0.0706709</td>
<td style="text-align: right;">0.5610389</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>model_refined <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> PC4 <span class="sc">+</span> PC6 <span class="sc">+</span> PC7, <span class="at">data =</span> merged_data_pca)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_refined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ PC1 + PC2 + PC4 + PC6 + PC7, data = merged_data_pca)

Residuals:
    Min      1Q  Median      3Q     Max 
-650.21 -101.61   -4.96   48.21 1691.77 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   115.06      20.84   5.522 1.79e-07 ***
PC1            74.32      13.23   5.616 1.16e-07 ***
PC2           -78.80      15.28  -5.156 9.31e-07 ***
PC4           -79.48      24.32  -3.268 0.001392 ** 
PC6           102.52      29.53   3.472 0.000705 ***
PC7            85.95      33.88   2.537 0.012383 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 241.2 on 128 degrees of freedom
Multiple R-squared:  0.4055,    Adjusted R-squared:  0.3823 
F-statistic: 17.46 on 5 and 128 DF,  p-value: 3.725e-13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_refined<span class="sc">$</span>fitted.values, <span class="fu">residuals</span>(model_refined), <span class="at">xlab =</span> <span class="st">"Fitted Values"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(model_refined))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(model_refined), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p>In defining the Principal components we can see the regression provided below, and so to talk to some of the key numbers that are present, focusing below on the variables where the “loading” listed indicated the correlation or contribution of each variable to each principal component. With the following being true</p>
<ul>
<li><p>A <strong>high positive loading</strong> (close to +1) means the variable is strongly positively correlated with the component.</p></li>
<li><p>A <strong>high negative loading</strong> (close to -1) means the variable is strongly negatively correlated with the component.</p></li>
<li><p>A loading close to <strong>0</strong> indicates a weak relationship.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 36%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">PC1</th>
<th style="text-align: right;">PC2</th>
<th style="text-align: right;">PC3</th>
<th style="text-align: right;">PC4</th>
<th style="text-align: right;">PC5</th>
<th style="text-align: right;">PC6</th>
<th style="text-align: right;">PC7</th>
<th style="text-align: right;">PC8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Elite Sport Ranking</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.59</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">-0.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sports Participation Rate</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.30</td>
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gym Memberships per 100k</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">-0.53</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.28</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hobbies - Health &amp; Fitness</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hobbies - Playing Sport</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">-0.46</td>
<td style="text-align: right;">-0.42</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hobbies - Watching Sport</td>
<td style="text-align: right;">-0.45</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.57</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fitness Apps</td>
<td style="text-align: right;">-0.40</td>
<td style="text-align: right;">-0.29</td>
<td style="text-align: right;">-0.46</td>
<td style="text-align: right;">-0.21</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-0.41</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">-0.55</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fitness Spend</td>
<td style="text-align: right;">-0.36</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.56</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This is where the analysis of probability of explanation comes into play, particularly noticed by the Pr(&gt;|t|) value and the R-squared adding some context to the explanation. With the importance of the Principal components defined by the signif. codes to show how explainable it was.</p>
<p>Again this is primarily focused on the coding for the analysis however part of analyzing any good data source is the statistics behind it and as such I won’t talk in too much depth, however provided is the statistics behind the claims made (enjoy).</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ ., data = merged_data_pca)

Residuals:
    Min      1Q  Median      3Q     Max 
-579.26 -103.39   -0.92   46.84 1677.87 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   115.06      20.66   5.568 1.50e-07 ***
PC1            74.32      13.12   5.663 9.68e-08 ***
PC2           -78.80      15.16  -5.200 7.91e-07 ***
PC3           -12.33      20.94  -0.589 0.557082    
PC4           -79.48      24.12  -3.295 0.001281 ** 
PC5           -37.92      24.51  -1.547 0.124435    
PC6           102.52      29.28   3.501 0.000643 ***
PC7            85.95      33.60   2.558 0.011717 *  
PC8            57.80      37.26   1.552 0.123300    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 239.2 on 125 degrees of freedom
Multiple R-squared:  0.429, Adjusted R-squared:  0.3925 
F-statistic: 11.74 on 8 and 125 DF,  p-value: 2.319e-12</code></pre>
</div>
</div>
<p>Next stages would be looking at the refined table by removing non critical factors these would be the values where Pr(&gt;|t|) is higher than its counterparts or closer to 1 which indicates that the relationship is higher likelihood of being based on chance than actual relationship. The removed data would be PC3,5 and 8 and result in the below Regression analysis resulting in an Adjusted R-Squared value of 0.38 which is not the greatest explanation however given that this is a macro level view (i.e.&nbsp;country) and focusing on sports culture a social science it is a reasonable rate.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ PC1 + PC2 + PC4 + PC6 + PC7, data = merged_data_pca)

Residuals:
    Min      1Q  Median      3Q     Max 
-650.21 -101.61   -4.96   48.21 1691.77 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   115.06      20.84   5.522 1.79e-07 ***
PC1            74.32      13.23   5.616 1.16e-07 ***
PC2           -78.80      15.28  -5.156 9.31e-07 ***
PC4           -79.48      24.32  -3.268 0.001392 ** 
PC6           102.52      29.53   3.472 0.000705 ***
PC7            85.95      33.88   2.537 0.012383 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 241.2 on 128 degrees of freedom
Multiple R-squared:  0.4055,    Adjusted R-squared:  0.3823 
F-statistic: 17.46 on 5 and 128 DF,  p-value: 3.725e-13</code></pre>
</div>
</div>
<p>So some of the key takeaways across the data focusing on three of the variables:</p>
<ul>
<li><p>Elite Sport Ranking - Countries with strong elite sport rankings tend to perform better</p></li>
<li><p>Sports Participation rate - Higher Sports participation rate correlate with better olympic results</p></li>
<li><p>Hobbies - Health &amp; Fitness - Countries where most people focus on personal fitness as a hobby may see indirect benefits in Olympic results.</p></li>
</ul>
</section>
</section>
<section id="population-sport-spending" class="level2">
<h2 class="anchored" data-anchor-id="population-sport-spending">Population Sport Spending</h2>
<p>The next component of investigation was spending in Sports at the Retail Value RSP in local currency for each country. For this data Euromonitor, does a great job of consolidating this information so that it is easier to do an analysis and uses a variety of sources such as the SEC &amp; IRS for the U.S numbers as official sources and many more. The first part of this was to normalize the numbers as they were in local currencies and aggregated in different capacity (some in millions, others in billions).</p>
<details>
<summary>
Euromonitor Sports Spend file read
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Sports_spend <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Passport_Stats_10-12-2024_0544_GMT.csv"</span>, <span class="at">skip =</span> <span class="dv">5</span>, <span class="at">header =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Currency =</span>  <span class="fu">substr</span>(Unit, <span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X2023 =</span> <span class="fu">str_replace_all</span>(X2023, <span class="st">","</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X2023 =</span> <span class="fu">as.numeric</span>(X2023)) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Category) <span class="sc">&amp;</span> Category <span class="sc">!=</span> <span class="st">""</span>) </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Given that Euromonitor does not have an API, and the shared license makes it difficult to parse the information, I downloaded and uploaded the information and focused on 2023</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="at">n =</span> <span class="dv">5</span>, Sports_spend)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Geography           Category        Data.Type        Unit
1            China Outdoor and Sports Retail Value RSP CNY million
2 Hong Kong, China Outdoor and Sports Retail Value RSP HKD million
3            India Outdoor and Sports Retail Value RSP INR million
4        Indonesia Outdoor and Sports Retail Value RSP IDR billion
5            Japan Outdoor and Sports Retail Value RSP JPY billion
  Current.Constant  X2023 Currency
1   Current Prices 2458.7      CNY
2   Current Prices   70.3      HKD
3   Current Prices 1203.7      INR
4   Current Prices  211.7      IDR
5   Current Prices   13.1      JPY</code></pre>
</div>
</div>
</details>
<details>
<summary>
Extract FX rates
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>unique_currencies <span class="ot">&lt;-</span> Sports_spend <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Currency) <span class="sc">|&gt;</span>   <span class="co"># Get unique currencies</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Currency)    </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the unique currencies into a comma-separated string</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>currency_string <span class="ot">&lt;-</span> <span class="fu">paste</span>(unique_currencies, <span class="at">collapse =</span> <span class="st">","</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting up an api key for the extract of Exchange Rates</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>Exchange_rate_api <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"exchange rates api.txt"</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Downloading the exchange rates from the provided API</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>Exchange_rate_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://api.exchangeratesapi.io/v1/2023-12-31?access_key="</span>,Exchange_rate_api,<span class="st">"&amp;symbols="</span>,currency_string,<span class="st">"&amp;format=1"</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Download the information</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>Exchange_rate <span class="ot">&lt;-</span> <span class="fu">GET</span>(Exchange_rate_url)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Parse the information</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>Usable_Exchange <span class="ot">&lt;-</span> <span class="fu">content</span>(Exchange_rate, <span class="st">"parsed"</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>rates_table <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Usable_Exchange<span class="sc">$</span>rates)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> rates_table <span class="sc">|&gt;</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(),    <span class="co"># Select all columns</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Currency"</span>,  <span class="co"># New column for the headers</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span>     <span class="co"># New column for the values</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting it up as USD related focus of investment</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>USD_Value <span class="ot">&lt;-</span> long_data <span class="sc">|&gt;</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Currency <span class="sc">==</span> <span class="st">"USD"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Value)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>Rates <span class="ot">&lt;-</span> long_data <span class="sc">|&gt;</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Value_USD =</span> <span class="fu">as.numeric</span>(<span class="dv">1</span><span class="sc">/</span>(Value<span class="sc">/</span>USD_Value)))</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting everything to USD </span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>Sports_spend <span class="ot">&lt;-</span> Sports_spend <span class="sc">|&gt;</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Rates,Sports_spend, <span class="at">by =</span> (<span class="st">"Currency"</span>))</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Joining in the amount spent for Sports with the local currency adjustment to USD.</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>Sports_spend <span class="ot">&lt;-</span> Sports_spend <span class="sc">|&gt;</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X2023_USD =</span> X2023<span class="sc">*</span>Value_USD,</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">Last7 =</span> <span class="fu">str_sub</span>(Unit, <span class="sc">-</span><span class="dv">7</span>),  <span class="co"># Extract the last 7 characters i.e. million or billion</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">Multiplier =</span> <span class="fu">ifelse</span>(Last7 <span class="sc">==</span> <span class="st">"million"</span>, <span class="dv">1000000</span>, <span class="dv">1000000000</span>), <span class="co"># Set multiplier based on condition</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">X2023_USD =</span> X2023_USD<span class="sc">*</span>Multiplier)</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Sports_spend)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Geography</th>
<th style="text-align: left;">Category</th>
<th style="text-align: left;">Data.Type</th>
<th style="text-align: left;">Unit</th>
<th style="text-align: left;">Current.Constant</th>
<th style="text-align: right;">X2023</th>
<th style="text-align: left;">Currency</th>
<th style="text-align: right;">Value</th>
<th style="text-align: right;">Value_USD</th>
<th style="text-align: right;">X2023_USD</th>
<th style="text-align: left;">Last7</th>
<th style="text-align: right;">Multiplier</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">China</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">CNY million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">2458.7</td>
<td style="text-align: left;">CNY</td>
<td style="text-align: right;">7.825079</td>
<td style="text-align: right;">0.1412709</td>
<td style="text-align: right;">347342777</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hong Kong, China</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">HKD million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">70.3</td>
<td style="text-align: left;">HKD</td>
<td style="text-align: right;">8.632571</td>
<td style="text-align: right;">0.1280564</td>
<td style="text-align: right;">9002365</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">India</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">INR million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">1203.7</td>
<td style="text-align: left;">INR</td>
<td style="text-align: right;">92.027926</td>
<td style="text-align: right;">0.0120122</td>
<td style="text-align: right;">14459061</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Indonesia</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">IDR billion</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">211.7</td>
<td style="text-align: left;">IDR</td>
<td style="text-align: right;">17013.075723</td>
<td style="text-align: right;">0.0000650</td>
<td style="text-align: right;">13755598</td>
<td style="text-align: left;">billion</td>
<td style="text-align: right;">1e+09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Japan</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">JPY billion</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">13.1</td>
<td style="text-align: left;">JPY</td>
<td style="text-align: right;">155.900774</td>
<td style="text-align: right;">0.0070908</td>
<td style="text-align: right;">92889042</td>
<td style="text-align: left;">billion</td>
<td style="text-align: right;">1e+09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malaysia</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">MYR million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">77.7</td>
<td style="text-align: left;">MYR</td>
<td style="text-align: right;">5.079529</td>
<td style="text-align: right;">0.2176296</td>
<td style="text-align: right;">16909822</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Philippines</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">PHP million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">474.9</td>
<td style="text-align: left;">PHP</td>
<td style="text-align: right;">61.238406</td>
<td style="text-align: right;">0.0180517</td>
<td style="text-align: right;">8572742</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Singapore</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">SGD million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">12.2</td>
<td style="text-align: left;">SGD</td>
<td style="text-align: right;">1.458677</td>
<td style="text-align: right;">0.7578484</td>
<td style="text-align: right;">9245750</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South Korea</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">KRW billion</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">15.1</td>
<td style="text-align: left;">KRW</td>
<td style="text-align: right;">1431.045823</td>
<td style="text-align: right;">0.0007725</td>
<td style="text-align: right;">11664466</td>
<td style="text-align: left;">billion</td>
<td style="text-align: right;">1e+09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Taiwan</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">TWD million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">330.1</td>
<td style="text-align: left;">TWD</td>
<td style="text-align: right;">33.919310</td>
<td style="text-align: right;">0.0325908</td>
<td style="text-align: right;">10758209</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Thailand</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">THB million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">347.6</td>
<td style="text-align: left;">THB</td>
<td style="text-align: right;">38.066335</td>
<td style="text-align: right;">0.0290403</td>
<td style="text-align: right;">10094392</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Australia</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">AUD million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">133.7</td>
<td style="text-align: left;">AUD</td>
<td style="text-align: right;">1.622777</td>
<td style="text-align: right;">0.6812125</td>
<td style="text-align: right;">91078113</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Poland</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">PLN million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">202.3</td>
<td style="text-align: left;">PLN</td>
<td style="text-align: right;">4.344490</td>
<td style="text-align: right;">0.2544501</td>
<td style="text-align: right;">51475259</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Romania</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">RON million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">51.8</td>
<td style="text-align: left;">RON</td>
<td style="text-align: right;">4.978393</td>
<td style="text-align: right;">0.2220508</td>
<td style="text-align: right;">11502230</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Russia</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">RUB million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">14083.7</td>
<td style="text-align: left;">RUB</td>
<td style="text-align: right;">98.661662</td>
<td style="text-align: right;">0.0112045</td>
<td style="text-align: right;">157801018</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ukraine</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">UAH million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">211.2</td>
<td style="text-align: left;">UAH</td>
<td style="text-align: right;">42.111813</td>
<td style="text-align: right;">0.0262505</td>
<td style="text-align: right;">5544105</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Argentina</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">ARS million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">7867.7</td>
<td style="text-align: left;">ARS</td>
<td style="text-align: right;">896.324454</td>
<td style="text-align: right;">0.0012333</td>
<td style="text-align: right;">9703402</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brazil</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">BRL million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">422.6</td>
<td style="text-align: left;">BRL</td>
<td style="text-align: right;">5.364221</td>
<td style="text-align: right;">0.2060795</td>
<td style="text-align: right;">87089198</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">MXN million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">1182.3</td>
<td style="text-align: left;">MXN</td>
<td style="text-align: right;">18.764278</td>
<td style="text-align: right;">0.0589128</td>
<td style="text-align: right;">69652594</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Africa</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">ZAR million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">536.9</td>
<td style="text-align: left;">ZAR</td>
<td style="text-align: right;">20.224535</td>
<td style="text-align: right;">0.0546592</td>
<td style="text-align: right;">29346500</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">United Arab Emirates</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">AED million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">75.5</td>
<td style="text-align: left;">AED</td>
<td style="text-align: right;">4.060068</td>
<td style="text-align: right;">0.2722752</td>
<td style="text-align: right;">20556781</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Canada</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">CAD million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">210.8</td>
<td style="text-align: left;">CAD</td>
<td style="text-align: right;">1.464723</td>
<td style="text-align: right;">0.7547202</td>
<td style="text-align: right;">159095013</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">USA</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">USD million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">1985.5</td>
<td style="text-align: left;">USD</td>
<td style="text-align: right;">1.105456</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">1985500000</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">France</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">EUR million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">356.6</td>
<td style="text-align: left;">EUR</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">1.1054560</td>
<td style="text-align: right;">394205610</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">EUR million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">176.6</td>
<td style="text-align: left;">EUR</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">1.1054560</td>
<td style="text-align: right;">195223530</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">EUR million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">90.8</td>
<td style="text-align: left;">EUR</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">1.1054560</td>
<td style="text-align: right;">100375405</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Netherlands</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">EUR million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">57.5</td>
<td style="text-align: left;">EUR</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">1.1054560</td>
<td style="text-align: right;">63563720</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">EUR million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">84.9</td>
<td style="text-align: left;">EUR</td>
<td style="text-align: right;">1.000000</td>
<td style="text-align: right;">1.1054560</td>
<td style="text-align: right;">93853214</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sweden</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">SEK million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">397.2</td>
<td style="text-align: left;">SEK</td>
<td style="text-align: right;">11.152225</td>
<td style="text-align: right;">0.0991243</td>
<td style="text-align: right;">39372154</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Switzerland</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">CHF million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">58.1</td>
<td style="text-align: left;">CHF</td>
<td style="text-align: right;">0.929683</td>
<td style="text-align: right;">1.1890677</td>
<td style="text-align: right;">69084832</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Turkey</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">TRY million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">386.3</td>
<td style="text-align: left;">TRY</td>
<td style="text-align: right;">32.463169</td>
<td style="text-align: right;">0.0340526</td>
<td style="text-align: right;">13154528</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
<tr class="even">
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: left;">Outdoor and Sports</td>
<td style="text-align: left;">Retail Value RSP</td>
<td style="text-align: left;">GBP million</td>
<td style="text-align: left;">Current Prices</td>
<td style="text-align: right;">162.4</td>
<td style="text-align: left;">GBP</td>
<td style="text-align: right;">0.868386</td>
<td style="text-align: right;">1.2730007</td>
<td style="text-align: right;">206735316</td>
<td style="text-align: left;">million</td>
<td style="text-align: right;">1e+06</td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<p>Aggregated USD amount spent on sports equipment in 2023 for 34 countries, to provide some context as to how much each country spends on sports. This will be cross referenced against the number of medals won.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Geography</th>
<th style="text-align: right;">USD Amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">USA</td>
<td style="text-align: right;">1985500000</td>
</tr>
<tr class="even">
<td style="text-align: left;">France</td>
<td style="text-align: right;">394205610</td>
</tr>
<tr class="odd">
<td style="text-align: left;">China</td>
<td style="text-align: right;">347342777</td>
</tr>
<tr class="even">
<td style="text-align: left;">United Kingdom</td>
<td style="text-align: right;">206735316</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Germany</td>
<td style="text-align: right;">195223530</td>
</tr>
<tr class="even">
<td style="text-align: left;">Canada</td>
<td style="text-align: right;">159095013</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Russia</td>
<td style="text-align: right;">157801018</td>
</tr>
<tr class="even">
<td style="text-align: left;">Italy</td>
<td style="text-align: right;">100375405</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spain</td>
<td style="text-align: right;">93853214</td>
</tr>
<tr class="even">
<td style="text-align: left;">Japan</td>
<td style="text-align: right;">92889042</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Australia</td>
<td style="text-align: right;">91078113</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brazil</td>
<td style="text-align: right;">87089198</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico</td>
<td style="text-align: right;">69652594</td>
</tr>
<tr class="even">
<td style="text-align: left;">Switzerland</td>
<td style="text-align: right;">69084832</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Netherlands</td>
<td style="text-align: right;">63563720</td>
</tr>
<tr class="even">
<td style="text-align: left;">Poland</td>
<td style="text-align: right;">51475259</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sweden</td>
<td style="text-align: right;">39372154</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Africa</td>
<td style="text-align: right;">29346500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">United Arab Emirates</td>
<td style="text-align: right;">20556781</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malaysia</td>
<td style="text-align: right;">16909822</td>
</tr>
<tr class="odd">
<td style="text-align: left;">India</td>
<td style="text-align: right;">14459061</td>
</tr>
<tr class="even">
<td style="text-align: left;">Indonesia</td>
<td style="text-align: right;">13755598</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Turkey</td>
<td style="text-align: right;">13154528</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Korea</td>
<td style="text-align: right;">11664466</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Romania</td>
<td style="text-align: right;">11502230</td>
</tr>
<tr class="even">
<td style="text-align: left;">Taiwan</td>
<td style="text-align: right;">10758209</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Thailand</td>
<td style="text-align: right;">10094392</td>
</tr>
<tr class="even">
<td style="text-align: left;">Argentina</td>
<td style="text-align: right;">9703402</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Singapore</td>
<td style="text-align: right;">9245750</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hong Kong, China</td>
<td style="text-align: right;">9002365</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Philippines</td>
<td style="text-align: right;">8572742</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ukraine</td>
<td style="text-align: right;">5544105</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>After all of this sports spend we tie it back to the original question which is how does sports spending relate to Olympic medals won, we join the legacy data of Olympic medals to the new sport spend data that was listed above.</p>
<p>It is interesting to compare the R-squared values in the Olympic medal regression analysis where this model of current spend (i.e.&nbsp;2023 USD in millions) is a better estimator of winning an Olympic medal compared to the previous analysis focused on hobbies and International sports ranking. The confidence P-value is indicative of this, feel free to further dive into the data below.</p>
<details>
<summary>
Regression of Medals to Amount spent
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Sports_spend_medals <span class="ot">&lt;-</span> Sports_spend <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Geography =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    Geography <span class="sc">==</span> <span class="st">"USA"</span> <span class="sc">~</span> <span class="st">"United States of America"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    Geography <span class="sc">==</span> <span class="st">"Hong Kong, China"</span> <span class="sc">~</span> <span class="st">"Hong Kong"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> Geography)) <span class="sc">|&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X2023_USD =</span> X2023_USD<span class="sc">/</span><span class="dv">1000000</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data <span class="sc">|&gt;</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(<span class="st">`</span><span class="at">Olympic Medals</span><span class="st">`</span>,Country), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Geography"</span> <span class="ot">=</span> <span class="st">"Country"</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Olympic Medals</span><span class="st">`</span> <span class="sc">~</span> X2023_USD, <span class="at">data =</span> Sports_spend_medals)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the summary of the regression model (code suppressed here and hidden overall)</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = `Olympic Medals` ~ X2023_USD, data = Sports_spend_medals)

Residuals:
    Min      1Q  Median      3Q     Max 
-227.21 -189.68 -115.48   58.82 1153.54 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 203.2603    60.9761   3.333  0.00229 ** 
X2023_USD     1.2624     0.1642   7.689 1.41e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 320.4 on 30 degrees of freedom
Multiple R-squared:  0.6634,    Adjusted R-squared:  0.6521 
F-statistic: 59.11 on 1 and 30 DF,  p-value: 1.412e-08</code></pre>
</div>
</div>
</details>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = `Olympic Medals` ~ X2023_USD, data = Sports_spend_medals)

Residuals:
    Min      1Q  Median      3Q     Max 
-227.21 -189.68 -115.48   58.82 1153.54 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 203.2603    60.9761   3.333  0.00229 ** 
X2023_USD     1.2624     0.1642   7.689 1.41e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 320.4 on 30 degrees of freedom
Multiple R-squared:  0.6634,    Adjusted R-squared:  0.6521 
F-statistic: 59.11 on 1 and 30 DF,  p-value: 1.412e-08</code></pre>
</div>
</div>
<p>To further cement all of this, a graph has been provided below with 95% confidence intervals to highlight the data spent, obviously this is difficult due to the closer grouping of the data to the under $250 million USD spent on sport related items. Further analysis could definitely be performed here to complete a logarithmic analysis or some alternative type.</p>
<details>
<summary>
Plotting Spend vs Olympic medals
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the formula</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>formula_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"y = "</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">1</span>], <span class="dv">2</span>), </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">" + "</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">"x"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Sports_spend_medals, <span class="fu">aes</span>(<span class="at">x =</span> X2023_USD, <span class="at">y =</span> <span class="st">`</span><span class="at">Olympic Medals</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">1000</span>, <span class="at">y =</span> <span class="dv">2000</span>, <span class="at">label =</span> formula_text, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Sports Spending vs Olympic Medals"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Sports Spending in 2023 (Million USD)"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Olympic Medals"</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Olympic_Spend_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>All of this shows the more that a country spends the more Olympic medals that are won with it only costing roughly a million USD for population per medal won.</p>
<p>Thank you for reading the analysis, I would highly recommend again reviewing my colleagues research into the other 4 components or the over-view non technical analysis. Otherwise feel free to connect via <a href="https://www.linkedin.com/in/william-j-peters-2018/">Linkedin</a> to discuss this topic further, or generally to talk about coding, financial services or low-code no code tools as that is my specialty.</p>
<p>References:</p>
<ol type="1">
<li><p>Halsall, A. (2021, July 8). <em>Which are the world’s sportiest countries? - MYPROTEINTM</em>. MYPROTEIN. https://us.myprotein.com/thezone/motivation/which-are-the-worlds-sportiest-countries/</p></li>
<li><p>Euromonitor International. (2022). <em>Outdoor and sports market size dataset</em>. [Data file]. Retrieved from <a href="https://www.euromonitor.com" class="uri">https://www.euromonitor.com</a></p></li>
<li><p>Exchange Rates API. (n.d.). <em>Documentation</em>. Retrieved from <a href="https://exchangeratesapi.io/documentation" class="uri">https://exchangeratesapi.io/documentation</a></p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/will-peters\.github\.io\/STA9750-2024-FALL\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>